{"ast":null,"code":"// Importera dina verktyg\nimport { apiKey, baseURL } from \"../utils.ts\";\n\n// Definiera typer fÃ¶r API-respons\n\n// Auth-modulen\nconst auth = {\n  token: \"\",\n  // Typa login-metoden\n  async login(username, password) {\n    const user = {\n      mail: username,\n      password: password,\n      api_key: apiKey\n    };\n    const response = await fetch(`${baseURL}/v1/user/login`, {\n      body: JSON.stringify(user),\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      method: \"POST\"\n    });\n    const result = await response.json();\n    if (result.message === 'Auth failed') {\n      return result.message;\n    } else if (result.message === 'Auth successful') {\n      this.token = result.token;\n      console.log(this.token);\n      return \"ok\";\n    } else {\n      return \"Unexpected error occurred.\";\n    }\n  },\n  // Typa register-metoden\n  async register(username, password, email, role) {\n    const user = {\n      mail: email,\n      password: password,\n      name: username,\n      role: role,\n      api_key: apiKey\n    };\n    const response = await fetch(`${baseURL}/v1/user/signup`, {\n      body: JSON.stringify(user),\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      method: \"POST\"\n    });\n    const result = await response.json();\n    console.log(result);\n    if (result.message === 'Mail exists') {\n      return result.message;\n    } else if (result.message === 'User has been created') {\n      return \"ok\";\n    } else {\n      return \"Unexpected error occurred.\";\n    }\n  }\n};\nexport default auth;","map":{"version":3,"names":["apiKey","baseURL","auth","token","login","username","password","user","mail","api_key","response","fetch","body","JSON","stringify","headers","method","result","json","message","console","log","register","email","role","name"],"sources":["/home/lutfia/Private_projects/vteam07/customer-side/src/modules/auth.ts"],"sourcesContent":["// Importera dina verktyg\r\nimport { apiKey, baseURL } from \"../utils.ts\";\r\n\r\n// Definiera typer fÃ¶r API-respons\r\ninterface ApiResponse<T> {\r\n  data?: T;\r\n  message?: string;\r\n  token: string;\r\n  errors?: {\r\n    detail: string;\r\n  };\r\n}\r\n\r\ninterface AuthData {\r\n  token: string;\r\n}\r\n\r\ninterface UserCredentials {\r\n  mail: string;\r\n  password: string;\r\n  role: string;\r\n  name: string;\r\n  api_key: string;\r\n}\r\n\r\ninterface UserCredentialsLogin {\r\n  mail: string;\r\n  password: string;\r\n  api_key: string;\r\n}\r\n\r\n\r\n// Auth-modulen\r\nconst auth = {\r\n  token: \"\",\r\n\r\n  // Typa login-metoden\r\n  async login(username: string, password: string): Promise<string> {\r\n    const user: UserCredentialsLogin = {\r\n      mail: username,\r\n      password: password,\r\n      api_key: apiKey,\r\n    };\r\n\r\n    const response = await fetch(`${baseURL}/v1/user/login`, {\r\n      body: JSON.stringify(user),\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      method: \"POST\",\r\n    });\r\n\r\n    const result: ApiResponse<AuthData> = await response.json();\r\n\r\n    if (result.message === 'Auth failed') {\r\n      return result.message;\r\n    } else if (result.message === 'Auth successful') {\r\n      \r\n      this.token = result.token;\r\n      console.log(this.token);\r\n      return \"ok\";\r\n    } else {\r\n      return \"Unexpected error occurred.\";\r\n    }\r\n\r\n\r\n  },\r\n\r\n  // Typa register-metoden\r\n  async register(username: string, password: string, email: string, role: string): Promise<string> {\r\n    const user: UserCredentials = {\r\n      mail: email,\r\n      password: password,\r\n      name: username,\r\n      role: role,\r\n      api_key: apiKey,\r\n    };\r\n\r\n    const response = await fetch(`${baseURL}/v1/user/signup`, {\r\n      body: JSON.stringify(user),\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      method: \"POST\",\r\n    });\r\n\r\n    const result: ApiResponse<AuthData> = await response.json();\r\n     console.log(result);\r\n    if (result.message === 'Mail exists') {\r\n      return result.message;\r\n    } else if (result.message === 'User has been created') {\r\n      \r\n      return \"ok\";\r\n    } else {\r\n      return \"Unexpected error occurred.\";\r\n    }\r\n  },\r\n};\r\n\r\nexport default auth;\r\n"],"mappings":"AAAA;AACA,SAASA,MAAM,EAAEC,OAAO,QAAQ,aAAa;;AAE7C;;AA6BA;AACA,MAAMC,IAAI,GAAG;EACXC,KAAK,EAAE,EAAE;EAET;EACA,MAAMC,KAAKA,CAACC,QAAgB,EAAEC,QAAgB,EAAmB;IAC/D,MAAMC,IAA0B,GAAG;MACjCC,IAAI,EAAEH,QAAQ;MACdC,QAAQ,EAAEA,QAAQ;MAClBG,OAAO,EAAET;IACX,CAAC;IAED,MAAMU,QAAQ,GAAG,MAAMC,KAAK,CAAC,GAAGV,OAAO,gBAAgB,EAAE;MACvDW,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACP,IAAI,CAAC;MAC1BQ,OAAO,EAAE;QACP,cAAc,EAAE;MAClB,CAAC;MACDC,MAAM,EAAE;IACV,CAAC,CAAC;IAEF,MAAMC,MAA6B,GAAG,MAAMP,QAAQ,CAACQ,IAAI,CAAC,CAAC;IAE3D,IAAID,MAAM,CAACE,OAAO,KAAK,aAAa,EAAE;MACpC,OAAOF,MAAM,CAACE,OAAO;IACvB,CAAC,MAAM,IAAIF,MAAM,CAACE,OAAO,KAAK,iBAAiB,EAAE;MAE/C,IAAI,CAAChB,KAAK,GAAGc,MAAM,CAACd,KAAK;MACzBiB,OAAO,CAACC,GAAG,CAAC,IAAI,CAAClB,KAAK,CAAC;MACvB,OAAO,IAAI;IACb,CAAC,MAAM;MACL,OAAO,4BAA4B;IACrC;EAGF,CAAC;EAED;EACA,MAAMmB,QAAQA,CAACjB,QAAgB,EAAEC,QAAgB,EAAEiB,KAAa,EAAEC,IAAY,EAAmB;IAC/F,MAAMjB,IAAqB,GAAG;MAC5BC,IAAI,EAAEe,KAAK;MACXjB,QAAQ,EAAEA,QAAQ;MAClBmB,IAAI,EAAEpB,QAAQ;MACdmB,IAAI,EAAEA,IAAI;MACVf,OAAO,EAAET;IACX,CAAC;IAED,MAAMU,QAAQ,GAAG,MAAMC,KAAK,CAAC,GAAGV,OAAO,iBAAiB,EAAE;MACxDW,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACP,IAAI,CAAC;MAC1BQ,OAAO,EAAE;QACP,cAAc,EAAE;MAClB,CAAC;MACDC,MAAM,EAAE;IACV,CAAC,CAAC;IAEF,MAAMC,MAA6B,GAAG,MAAMP,QAAQ,CAACQ,IAAI,CAAC,CAAC;IAC1DE,OAAO,CAACC,GAAG,CAACJ,MAAM,CAAC;IACpB,IAAIA,MAAM,CAACE,OAAO,KAAK,aAAa,EAAE;MACpC,OAAOF,MAAM,CAACE,OAAO;IACvB,CAAC,MAAM,IAAIF,MAAM,CAACE,OAAO,KAAK,uBAAuB,EAAE;MAErD,OAAO,IAAI;IACb,CAAC,MAAM;MACL,OAAO,4BAA4B;IACrC;EACF;AACF,CAAC;AAED,eAAejB,IAAI","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}